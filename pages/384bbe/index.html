<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>golang夯实基础第七天 | 小小程知识库</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="https://cdn-static.xxcheng.cn/static/public/logo/64_64.ico">
    <meta name="description" content="个人总结知识库,专注前端、Golang">
    <meta name="keywords" content="xxcheng知识库,小小程知识库,知识库,前端知识库,Golang知识库,前端,前端开发,前端框架,web前端,技术文档,学习,JavaScript,js,ES6,TypeScript,vue,golang,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="z3ADKJ0W8g">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.bf945c37.css" as="style"><link rel="preload" href="/assets/js/app.93b3f0b1.js" as="script"><link rel="preload" href="/assets/js/2.aec7a7f0.js" as="script"><link rel="preload" href="/assets/js/21.8ccae75c.js" as="script"><link rel="prefetch" href="/assets/js/10.300e00aa.js"><link rel="prefetch" href="/assets/js/11.0e98b3ed.js"><link rel="prefetch" href="/assets/js/12.6f626e41.js"><link rel="prefetch" href="/assets/js/13.d0c640b1.js"><link rel="prefetch" href="/assets/js/14.eebbe75b.js"><link rel="prefetch" href="/assets/js/15.b16a109f.js"><link rel="prefetch" href="/assets/js/16.9f2e200b.js"><link rel="prefetch" href="/assets/js/17.142a03c6.js"><link rel="prefetch" href="/assets/js/18.cd8ac442.js"><link rel="prefetch" href="/assets/js/19.487fc2bb.js"><link rel="prefetch" href="/assets/js/20.3cb2c94c.js"><link rel="prefetch" href="/assets/js/22.aeababc9.js"><link rel="prefetch" href="/assets/js/23.bb235707.js"><link rel="prefetch" href="/assets/js/24.a45213d4.js"><link rel="prefetch" href="/assets/js/25.695efc2d.js"><link rel="prefetch" href="/assets/js/26.6e0dcbe0.js"><link rel="prefetch" href="/assets/js/27.1a3008d3.js"><link rel="prefetch" href="/assets/js/28.c84eaeb6.js"><link rel="prefetch" href="/assets/js/29.5b4cfd9b.js"><link rel="prefetch" href="/assets/js/3.8522f2e0.js"><link rel="prefetch" href="/assets/js/30.02405b51.js"><link rel="prefetch" href="/assets/js/31.0de66001.js"><link rel="prefetch" href="/assets/js/32.f35acc80.js"><link rel="prefetch" href="/assets/js/33.1265ba71.js"><link rel="prefetch" href="/assets/js/34.a18cf05a.js"><link rel="prefetch" href="/assets/js/35.479f7270.js"><link rel="prefetch" href="/assets/js/36.9f67f7ae.js"><link rel="prefetch" href="/assets/js/37.80172425.js"><link rel="prefetch" href="/assets/js/38.f1e60099.js"><link rel="prefetch" href="/assets/js/39.ac180027.js"><link rel="prefetch" href="/assets/js/4.b2ea6df6.js"><link rel="prefetch" href="/assets/js/40.d00d1f40.js"><link rel="prefetch" href="/assets/js/5.f0502413.js"><link rel="prefetch" href="/assets/js/6.c2d1667e.js"><link rel="prefetch" href="/assets/js/7.7a24b5ef.js"><link rel="prefetch" href="/assets/js/8.50820b2d.js"><link rel="prefetch" href="/assets/js/9.65fae3ee.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bf945c37.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cdn-static.xxcheng.cn/static/public/logo/640_640.png" alt="小小程知识库" class="logo"> <span class="site-name can-hide">小小程知识库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/golang/" class="nav-link">Golang</a></div><div class="nav-item"><a href="/mysql/" class="nav-link">MySQL</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/xxcheng123/xxcheng-repository" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn-static.xxcheng.cn/static/public/logo/640_640.png"> <div class="blogger-info"><h3>xxcheng</h3> <span>记录美好生活~</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/golang/" class="nav-link">Golang</a></div><div class="nav-item"><a href="/mysql/" class="nav-link">MySQL</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/xxcheng123/xxcheng-repository" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>语言基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GORM 框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>go-zero 微服务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>专题学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>未整理的学习笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/bb6d47/" class="sidebar-link">golang夯实基础第一天</a></li><li><a href="/pages/b09049/" class="sidebar-link">golang夯实基础第二天</a></li><li><a href="/pages/76e5e3/" class="sidebar-link">golang夯实基础第三天</a></li><li><a href="/pages/87d444/" class="sidebar-link">golang夯实基础第四天</a></li><li><a href="/pages/85fe75/" class="sidebar-link">golang夯实基础第五天</a></li><li><a href="/pages/535f9a/" class="sidebar-link">golang夯实基础第六天</a></li><li><a href="/pages/384bbe/" aria-current="page" class="active sidebar-link">golang夯实基础第七天</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#panic" class="sidebar-link">panic</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#recover" class="sidebar-link">recover</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#有效的-recover" class="sidebar-link">有效的 recover</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#自定义-error" class="sidebar-link">自定义 error</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#分类" class="sidebar-link">分类</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#文件名-方法名规范" class="sidebar-link">文件名 &amp; 方法名规范</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#参数-常用" class="sidebar-link">参数（常用）</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#测试函数" class="sidebar-link">测试函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#基本格式" class="sidebar-link">基本格式</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#常用方法" class="sidebar-link">常用方法</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#error-、errorf" class="sidebar-link">Error 、Errorf</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#log、logf" class="sidebar-link">Log、Logf</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#基本测试" class="sidebar-link">基本测试</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#单函数" class="sidebar-link">单函数</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#多函数" class="sidebar-link">多函数</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#测试不通过示例" class="sidebar-link">测试不通过示例</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#查看每个参数函数具体信息-v-参数" class="sidebar-link">查看每个参数函数具体信息 -v 参数</a></li><li class="sidebar-sub-header level5"><a href="/pages/384bbe/#执行-多函数-示例-join-test-go-文件" class="sidebar-link">执行 多函数 示例 join_test.go 文件</a></li><li class="sidebar-sub-header level5"><a href="/pages/384bbe/#执行-测试不通过示例-示例-join-test-go-文件" class="sidebar-link">执行 测试不通过示例 示例 join_test.go 文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#指定执行某个测试函数-run-参数" class="sidebar-link">指定执行某个测试函数 -run 参数</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#测试组" class="sidebar-link">测试组</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#子测试" class="sidebar-link">子测试</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#测试覆盖率" class="sidebar-link">测试覆盖率</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#基准测试" class="sidebar-link">基准测试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#基本格式-2" class="sidebar-link">基本格式</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#基本测试-2" class="sidebar-link">基本测试</a></li><li class="sidebar-sub-header level5"><a href="/pages/384bbe/#相关结果说明" class="sidebar-link">相关结果说明：</a></li><li class="sidebar-sub-header level5"><a href="/pages/384bbe/#相关结果说明-2" class="sidebar-link">相关结果说明：</a></li><li class="sidebar-sub-header level5"><a href="/pages/384bbe/#相关结果说明-3" class="sidebar-link">相关结果说明：</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#性能比较函数" class="sidebar-link">性能比较函数</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#重置运行时间" class="sidebar-link">重置运行时间</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#并行测试" class="sidebar-link">并行测试</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#示例测试" class="sidebar-link">示例测试</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#基本格式-3" class="sidebar-link">基本格式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#基本示例" class="sidebar-link">基本示例</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#testmain" class="sidebar-link">TestMain</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#语法" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#示例" class="sidebar-link">示例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#只能在一个包内" class="sidebar-link">只能在一个包内</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#基础类型的接收者" class="sidebar-link">基础类型的接收者</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#不区分普通类型还是指针类型的接收者" class="sidebar-link">不区分普通类型还是指针类型的接收者</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#匿名字段" class="sidebar-link">匿名字段</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#方法集" class="sidebar-link">方法集</a></li><li class="sidebar-sub-header level2"><a href="/pages/384bbe/#方法表达式" class="sidebar-link">方法表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#实现方式" class="sidebar-link">实现方式</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#method-value-方法值" class="sidebar-link">method value 方法值</a></li><li class="sidebar-sub-header level4"><a href="/pages/384bbe/#method-expression-方法表达式" class="sidebar-link">method expression 方法表达式</a></li><li class="sidebar-sub-header level3"><a href="/pages/384bbe/#示例-2" class="sidebar-link">示例</a></li></ul></li></ul></li><li><a href="/pages/5eee91/" class="sidebar-link">golang夯实基础第八天</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/golang/#Golang" data-v-06225672>Golang</a></li><li data-v-06225672><a href="/golang/#未整理的学习笔记" data-v-06225672>未整理的学习笔记</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://www.xxcheng.cn/" target="_blank" title="作者" class="beLink" data-v-06225672>xxcheng</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-07-08</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">golang夯实基础第七天<!----></h1>  <div class="theme-vdoing-content content__default"><ul><li><h1 id="异常处理"><a href="#异常处理" class="header-anchor">#</a> 异常处理</h1> <p><code>Go</code> 没有结构化的异常，只能使用 <code>panic</code> 内置函数抛出异常，<code>recover</code> 内置函数在 <code>defer</code> 中捕获异常，然后程序正常运行。</p> <ul><li><h2 id="panic"><a href="#panic" class="header-anchor">#</a> <code>panic</code></h2> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">panic</span><span class="token punctuation">(</span>v any<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>抛出异常的内置函数；</li> <li>可以在任何地方调用；</li></ul></li> <li><h2 id="recover"><a href="#recover" class="header-anchor">#</a> <code>recover</code></h2> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> any
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>捕获 <code>panicking</code> 行为的函数；</li> <li>可以在任何地方定义，但是只有在 <code>defer</code> 定义的函数或者调用的函数执行，才能起到实际作用，其他地方返回值恒为 <code>nil</code>；</li></ul></li> <li><h2 id="有效的-recover"><a href="#有效的-recover" class="header-anchor">#</a> 有效的 <code>recover</code></h2> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Test_07_1</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Test_07_1&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		err <span class="token operator">:=</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 有效</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;func recover&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 无效</span>
	<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 无效</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			err <span class="token operator">:=</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 无效</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;inner recover&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 无效</span>
	<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;故意的错误&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>Test_07_1
inner recover &lt;nil&gt;
&lt;nil&gt;
func recover 故意的错误
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><h2 id="自定义-error"><a href="#自定义-error" class="header-anchor">#</a> 自定义 <code>error</code></h2> <p><code>error</code> 是一个内置接口</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> <span class="token builtin">error</span> <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>所以主要实现了 <code>Error</code> 方法，就是一个 <code>error</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> MyError <span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m MyError<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	str <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;这是我自定义的一个Error，错误代码：%d&quot;</span><span class="token punctuation">,</span> <span class="token function">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> str

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">getError</span><span class="token punctuation">(</span>i <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> e MyError <span class="token operator">=</span> <span class="token function">MyError</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
	<span class="token keyword">return</span> e
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">Test_07_5</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	err <span class="token operator">:=</span> <span class="token function">getError</span><span class="token punctuation">(</span><span class="token number">999</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS single<span class="token punctuation">]</span><span class="token comment"># go test -v  day07_test.go -run Test_07_5</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   Test_07_5
这是我自定义的一个Error，错误代码：999
--- PASS: Test_07_5 <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
PASS
ok      command-line-arguments  <span class="token number">0.003</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul> <p>如果程序被 <code>panic</code> 抛出异常，那么之后所有的程序都不会再运行了，因此定义在 <code>panic</code> 之后的 <code>defer</code> 因为还没有被定义，所以也不会执行。</p></li> <li><h1 id="单元测试"><a href="#单元测试" class="header-anchor">#</a> 单元测试</h1> <p>使用 <code>go test</code> 命令，对包内以 <code>_test.go</code> 后缀执行测试，并且不会被 <code>go build</code> 编译到可执行文件中。</p> <ul><li><h2 id="分类"><a href="#分类" class="header-anchor">#</a> 分类</h2> <table><thead><tr><th style="text-align:center;">类型</th> <th style="text-align:center;">格式</th> <th style="text-align:center;">作用</th></tr></thead> <tbody><tr><td style="text-align:center;">测试函数</td> <td style="text-align:center;">函数前缀名为 <code>Test</code></td> <td style="text-align:center;">测试函数的逻辑是否正确</td></tr> <tr><td style="text-align:center;">基准函数</td> <td style="text-align:center;">函数前缀名为 <code>Benchmark</code></td> <td style="text-align:center;">测试函数的性能</td></tr> <tr><td style="text-align:center;">示例函数</td> <td style="text-align:center;">函数前缀名为 <code>Example</code></td> <td style="text-align:center;">为文档提供测试用例</td></tr></tbody></table></li> <li><h2 id="文件名-方法名规范"><a href="#文件名-方法名规范" class="header-anchor">#</a> 文件名 &amp; 方法名规范</h2> <ul><li>文件名必须以 <code>_test.go</code> 结尾，比如 <code>day07_test.go</code>；</li> <li>测试函数的函数名必须以 <code>Test</code> 开头，基准函数的函数名必须以 <code>Benchmark</code> 开头，示例函数的函数名必须以 <code>Example</code> 开头，且它们之后的第一个字母必须大写；</li> <li>测试函数的参数类型必须是 <code>* testing.T</code>，基准函数的参数类型必须是 <code>*testing.B</code>，示例函数的没有参数；</li></ul></li> <li><h2 id="参数-常用"><a href="#参数-常用" class="header-anchor">#</a> 参数（常用）</h2></li> <li><h2 id="测试函数"><a href="#测试函数" class="header-anchor">#</a> 测试函数</h2> <ul><li><h3 id="基本格式"><a href="#基本格式" class="header-anchor">#</a> 基本格式</h3> <p>以 <code>Test</code> 为前缀，接收一个 <code>*testing.T</code>类型的参数</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestName</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>testing.T</code> 拥有的方法：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Errorf</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">FailNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Failed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Fatal</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Fatalf</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Log</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Logf</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Run</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> f <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Skip</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">SkipNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Skipf</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Skipped</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>调用其中的 <code>Error</code>、<code>Errorf</code>、<code>FailNow</code>、<code>FatalFatalIf</code> 方法，说明测试不通过</p></li> <li><h3 id="常用方法"><a href="#常用方法" class="header-anchor">#</a> 常用方法</h3> <ul><li><h4 id="error-、errorf"><a href="#error-、errorf" class="header-anchor">#</a> <code>Error</code> 、<code>Errorf</code></h4> <p>抛出错误</p></li> <li><h4 id="log、logf"><a href="#log、logf" class="header-anchor">#</a> <code>Log</code>、<code>Logf</code></h4> <p>记录信息</p></li></ul></li> <li><h3 id="基本测试"><a href="#基本测试" class="header-anchor">#</a> 基本测试</h3> <p>目录结构：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">.</span>
├── go.mod
├── join.go
└── join_test.go

<span class="token number">0</span> directories, <span class="token number">3</span> files
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><em>join.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">func</span> <span class="token function">Join</span><span class="token punctuation">(</span>strSlice <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> sep <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>strSlice<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> strSlice <span class="token punctuation">{</span>
		s <span class="token operator">+=</span> value <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span>
	<span class="token punctuation">}</span>
	length <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	s <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token punctuation">:</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><h4 id="单函数"><a href="#单函数" class="header-anchor">#</a> 单函数</h4> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test</span>
PASS
ok      <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><h4 id="多函数"><a href="#多函数" class="header-anchor">#</a> 多函数</h4> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">TestJoinTwo</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test</span>
PASS
ok      <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><h4 id="测试不通过示例"><a href="#测试不通过示例" class="header-anchor">#</a> 测试不通过示例</h4> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">TestJoinTwo</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestJoinThree</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;null&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test</span>
--- FAIL: TestJoinThree <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    join_test.go:30: excepted:null, got:
FAIL
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><h4 id="查看每个参数函数具体信息-v-参数"><a href="#查看每个参数函数具体信息-v-参数" class="header-anchor">#</a> 查看每个参数函数具体信息 <code>-v</code> 参数</h4> <p>直接使用 <code>go test</code> 在这么多函数执行时不能查看每个函数的运行时间，这里可以添加 <code>-v</code> 参数查看每一个测试函数的具体信息</p> <ul><li><h5 id="执行-多函数-示例-join-test-go-文件"><a href="#执行-多函数-示例-join-test-go-文件" class="header-anchor">#</a> 执行 <code>多函数</code> 示例 <code>join_test.go</code> 文件</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -v</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin
--- PASS: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoinTwo
--- PASS: TestJoinTwo <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
PASS
ok      <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><h5 id="执行-测试不通过示例-示例-join-test-go-文件"><a href="#执行-测试不通过示例-示例-join-test-go-文件" class="header-anchor">#</a> 执行 <code>测试不通过示例</code> 示例 <code>join_test.go</code> 文件</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -v</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin
--- PASS: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoinTwo
--- PASS: TestJoinTwo <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoinThree
    join_test.go:30: excepted:null, got:
--- FAIL: TestJoinThree <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
FAIL
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul></li> <li><h4 id="指定执行某个测试函数-run-参数"><a href="#指定执行某个测试函数-run-参数" class="header-anchor">#</a> 指定执行某个测试函数 <code>-run</code> 参数</h4> <p><code>-run</code> 参数接收一个正则表达式，函数名匹配上的测试函数会被执行</p> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">TestJoinTwo</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestJoinTwo2</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;浙江&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;衢州&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;xxcheng&quot;</span><span class="token punctuation">}</span>
	got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	want <span class="token operator">:=</span> <span class="token string">&quot;中国-浙江-衢州-xxcheng&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -v -run JoinTwo</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoinTwo
--- PASS: TestJoinTwo <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoinTwo2
--- PASS: TestJoinTwo2 <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
PASS
ok      <span class="token function">join</span>    <span class="token number">0</span>.001s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>TestJoin</code> 函数未匹配，没有被执行</p></li></ul></li> <li><h3 id="测试组"><a href="#测试组" class="header-anchor">#</a> 测试组</h3> <p>每个测试都要写一个单独的函数没有必要，可以将多个测试用例写成一个数组或者切片，遍历运行。</p> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> test <span class="token keyword">struct</span> <span class="token punctuation">{</span>
		input <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
		sep   <span class="token builtin">string</span>
		want  <span class="token builtin">string</span>
	<span class="token punctuation">}</span>
	tests <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>test<span class="token punctuation">{</span>
		<span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> tc <span class="token operator">:=</span> <span class="token keyword">range</span> tests <span class="token punctuation">{</span>
		got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>tc<span class="token punctuation">.</span>input<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>sep<span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -v</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin
--- PASS: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
PASS
ok      <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> test <span class="token keyword">struct</span> <span class="token punctuation">{</span>
		input <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
		sep   <span class="token builtin">string</span>
		want  <span class="token builtin">string</span>
	<span class="token punctuation">}</span>
	tests <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>test<span class="token punctuation">{</span>
		<span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;null&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> tc <span class="token operator">:=</span> <span class="token keyword">range</span> tests <span class="token punctuation">{</span>
		got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>tc<span class="token punctuation">.</span>input<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>sep<span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -v</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin
    join_test.go:22: excepted:null, got:
--- FAIL: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
FAIL
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    <span class="token function">join</span>    <span class="token number">0</span>.042s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><h3 id="子测试"><a href="#子测试" class="header-anchor">#</a> 子测试</h3> <p>使用测试组虽然可以测试多组数据，但是如果在测试用例较多的情况下，出现了失败的测试用例，无法很快定位是哪个测试用例，所以我们可以给每一个测试用例设置一个名称，失败的时候将名称也打印输出，<code>Go1.7</code> 版本之后提供了子测试的函数 <code>T.Run</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>T<span class="token punctuation">)</span> <span class="token function">Run</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> f <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> test <span class="token keyword">struct</span> <span class="token punctuation">{</span>
		input <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
		sep   <span class="token builtin">string</span>
		want  <span class="token builtin">string</span>
	<span class="token punctuation">}</span>
	tests <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>test<span class="token punctuation">{</span>
		<span class="token string">&quot;simple&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;hgnu&quot;</span><span class="token punctuation">:</span>   <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;abc&quot;</span><span class="token punctuation">:</span>    <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;null&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> name<span class="token punctuation">,</span> tc <span class="token operator">:=</span> <span class="token keyword">range</span> tests <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>tc<span class="token punctuation">.</span>input<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>sep<span class="token punctuation">)</span>
			<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -v</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin/simple
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin/hgnu
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin/abc
    join_test.go:23: excepted:null, got:
--- FAIL: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- PASS: TestJoin/simple <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- PASS: TestJoin/hgnu <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- FAIL: TestJoin/abc <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
FAIL
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>可以很直观的看从来是 <code>abc</code> 这个测试用例出现了问题</p> <p>同时，它也可以使用 <code>-run</code> 正则指定运行</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -v -run TestJoin/hgnu</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin/hgnu
--- PASS: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- PASS: TestJoin/hgnu <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
PASS
ok      <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><h3 id="测试覆盖率"><a href="#测试覆盖率" class="header-anchor">#</a> 测试覆盖率</h3> <p>检查我们写的测试函数是否覆盖了我们写的代码，检查我们的覆盖率</p> <p>使用 <code>go test -cover</code> 检查覆盖率</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -cover</span>
--- FAIL: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- FAIL: TestJoin/abc <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
        join_test.go:23: excepted:null, got:
FAIL
        <span class="token function">join</span>    coverage: <span class="token number">100.0</span>% of statements
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    <span class="token function">join</span>    <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="https://cdn-static.xxcheng.cn/static/blog/images/2023/07/07/8ce1a1cc1a9fc2cd9ae27944f8f054e2.png" alt="image-20230707112119260"></p> <p>使用 <code>-coverprofile</code> 参数可以将检查结果输出到一个文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -cover -coverprofile=c.out</span>
--- FAIL: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- FAIL: TestJoin/abc <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
        join_test.go:23: excepted:null, got:
FAIL
        <span class="token function">join</span>    coverage: <span class="token number">100.0</span>% of statements
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    <span class="token function">join</span>    <span class="token number">0</span>.004s
<span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># tree</span>
<span class="token builtin class-name">.</span>
├── c.out
├── go.mod
├── join.go
└── join_test.go

<span class="token number">0</span> directories, <span class="token number">4</span> files
<span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># cat c.out</span>
mode: <span class="token builtin class-name">set</span>
join/join.go:3.53,4.24 <span class="token number">1</span> <span class="token number">1</span>
join/join.go:4.24,6.3 <span class="token number">1</span> <span class="token number">1</span>
join/join.go:7.2,7.33 <span class="token number">1</span> <span class="token number">1</span>
join/join.go:7.33,9.3 <span class="token number">1</span> <span class="token number">1</span>
join/join.go:10.2,12.8 <span class="token number">3</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>如果在 <code>join.go</code> 文件添加一个 <code>SayHello</code> 函数再测试</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">SayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -cover</span>
--- FAIL: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- FAIL: TestJoin/abc <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
        join_test.go:23: excepted:null, got:
FAIL
        <span class="token function">join</span>    coverage: <span class="token number">87.5</span>% of statements
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    <span class="token function">join</span>    <span class="token number">0</span>.003s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>覆盖率降为 <code>87.5%</code></p></li></ul></li> <li><h2 id="基准测试"><a href="#基准测试" class="header-anchor">#</a> 基准测试</h2> <ul><li><h3 id="基本格式-2"><a href="#基本格式-2" class="header-anchor">#</a> 基本格式</h3> <p>以 <code>Benchmark</code> 为前缀，接收一个 <code>*testing.B</code> 类型的参数，函数执行 <code>b.N</code> 次，来测试性能，<code>N</code>  的值根据系统实时自动调整的，<strong>不是固定不变的</strong></p> <p>使用 <code>-test.bench</code> 参数，可省略为 <code>-bench</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">BenchmarkName</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <p>}</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
`testing.B` 拥有的方法：

```go
func (c *B) Error(args ...interface{})
func (c *B) Errorf(format string, args ...interface{})
func (c *B) Fail()
func (c *B) FailNow()
func (c *B) Failed() bool
func (c *B) Fatal(args ...interface{})
func (c *B) Fatalf(format string, args ...interface{})
func (c *B) Log(args ...interface{})
func (c *B) Logf(format string, args ...interface{})
func (c *B) Name() string
func (b *B) ReportAllocs()
func (b *B) ResetTimer()
func (b *B) Run(name string, f func(b *B)) bool
func (b *B) RunParallel(body func(*PB))
func (b *B) SetBytes(n int64)
func (b *B) SetParallelism(p int)
func (c *B) Skip(args ...interface{})
func (c *B) SkipNow()
func (c *B) Skipf(format string, args ...interface{})
func (c *B) Skipped() bool
func (b *B) StartTimer()
func (b *B) StopTimer()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li><h3 id="基本测试-2"><a href="#基本测试-2" class="header-anchor">#</a> 基本测试</h3> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> test <span class="token keyword">struct</span> <span class="token punctuation">{</span>
		input <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
		sep   <span class="token builtin">string</span>
		want  <span class="token builtin">string</span>
	<span class="token punctuation">}</span>
	tests <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>test<span class="token punctuation">{</span>
		<span class="token string">&quot;simple&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;hgnu&quot;</span><span class="token punctuation">:</span>   <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// &quot;abc&quot;:    {[]string{}, &quot;-&quot;, &quot;null&quot;},</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> name<span class="token punctuation">,</span> tc <span class="token operator">:=</span> <span class="token keyword">range</span> tests <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>tc<span class="token punctuation">.</span>input<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>sep<span class="token punctuation">)</span>
			<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkJoin</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>N<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -v -bench=Join</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin/simple
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin/hgnu
--- PASS: TestJoin <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- PASS: TestJoin/simple <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    --- PASS: TestJoin/hgnu <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
goos: linux
goarch: amd64
pkg: <span class="token function">join</span>
cpu: AMD EPYC Processor
BenchmarkJoin
BenchmarkJoin-8          <span class="token number">7051003</span>               <span class="token number">171.1</span> ns/op
PASS
ok      <span class="token function">join</span>    <span class="token number">1</span>.519s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="相关结果说明"><a href="#相关结果说明" class="header-anchor">#</a> 相关结果说明：</h5> <ul><li><code>BenchmarkJoin-8</code>，<code>8</code> 表示 <code>GOMAXPROCS</code></li> <li><code>7051003</code> 调用次数</li> <li><code>171.1 ns/op</code> 调用7051003次平均执行时间</li></ul> <p>可以再添加一个 <code>-benchmem</code> 参数，统计内存相关数据</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span># <span class="token keyword">go</span> test <span class="token operator">-</span>v <span class="token operator">-</span>bench<span class="token operator">=</span>Join <span class="token operator">-</span>benchmem
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin<span class="token operator">/</span>simple
<span class="token operator">==</span><span class="token operator">=</span> RUN   TestJoin<span class="token operator">/</span>hgnu
<span class="token operator">--</span><span class="token operator">-</span> PASS<span class="token punctuation">:</span> TestJoin <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">.</span>00s<span class="token punctuation">)</span>
    <span class="token operator">--</span><span class="token operator">-</span> PASS<span class="token punctuation">:</span> TestJoin<span class="token operator">/</span>simple <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">.</span>00s<span class="token punctuation">)</span>
    <span class="token operator">--</span><span class="token operator">-</span> PASS<span class="token punctuation">:</span> TestJoin<span class="token operator">/</span>hgnu <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">.</span>00s<span class="token punctuation">)</span>
goos<span class="token punctuation">:</span> linux
goarch<span class="token punctuation">:</span> amd64
pkg<span class="token punctuation">:</span> join
cpu<span class="token punctuation">:</span> AMD EPYC Processor
BenchmarkJoin
BenchmarkJoin<span class="token operator">-</span><span class="token number">8</span>          <span class="token number">6850162</span>               <span class="token number">181.6</span> ns<span class="token operator">/</span>op            <span class="token number">32</span> B<span class="token operator">/</span>op          <span class="token number">3</span> allocs<span class="token operator">/</span>op
PASS
ok      join    <span class="token number">1</span><span class="token punctuation">.</span>569s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="相关结果说明-2"><a href="#相关结果说明-2" class="header-anchor">#</a> 相关结果说明：</h5> <ul><li><code>32 B/op</code> 表示平均每次分配了32个字节内存</li> <li><code>3 allocs/op</code> 表示平均每次进行了3次内存分配</li></ul> <p>下面对 <code>join.go</code> 的 <code>Join</code> 函数优化一下，再测试</p> <p><em>join.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">Join</span><span class="token punctuation">(</span>strSlice <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> sep <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>strSlice<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	length <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> strSlice <span class="token punctuation">{</span>
		length <span class="token operator">+=</span> <span class="token function">len</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	b <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> length<span class="token operator">+</span><span class="token function">len</span><span class="token punctuation">(</span>strSlice<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token comment">//使用strings.Count!@!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
	<span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> strSlice <span class="token punctuation">{</span>
		b <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token operator">...</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> index <span class="token operator">!=</span> <span class="token function">len</span><span class="token punctuation">(</span>strSlice<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">{</span>
			b <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token char">'-'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">string</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-she line-numbers-mode"><pre class="language-text"><code>[root@CentOS join]# go test -v -bench=Join -benchmem
=== RUN   TestJoin
=== RUN   TestJoin/simple
=== RUN   TestJoin/hgnu
--- PASS: TestJoin (0.00s)
    --- PASS: TestJoin/simple (0.00s)
    --- PASS: TestJoin/hgnu (0.00s)
goos: linux
goarch: amd64
pkg: join
cpu: AMD EPYC Processor
BenchmarkJoin
BenchmarkJoin-8         17493249                75.17 ns/op           16 B/op          1 allocs/op
PASS
ok      join    1.634s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="相关结果说明-3"><a href="#相关结果说明-3" class="header-anchor">#</a> 相关结果说明：</h5> <ul><li>程序执行耗时从之前的 <code>181.6 ns/op</code>  下降为 <code>75.17 ns/op</code>；</li> <li>内存分配字节从 <code>32 B/op</code> 下降为 <code>16 B/op</code>；</li> <li>内存分配次数从 <code>3 allocs/op</code> 下降为 <code>1 allocs/op</code>；</li></ul> <p>有力的证明了，优化能够对程序带来的提升</p></li> <li><h3 id="性能比较函数"><a href="#性能比较函数" class="header-anchor">#</a> 性能比较函数</h3> <p>上面的基础的基准测试只能得到相对的测试结果，不能计算相对的耗时，比如同一个函数，运行100次和10000次的耗时差别，或者执行一个任务，使用哪种算法最优？</p> <p>这时候就可以让他们同时执行一个任务，然后固定执行多少次，这里以斐波那契数列为例：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS fib<span class="token punctuation">]</span><span class="token comment"># tree</span>
<span class="token builtin class-name">.</span>
├── fib.go
├── fib_test.go
└── go.mod

<span class="token number">0</span> directories, <span class="token number">3</span> files
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><em>fib.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> fib

<span class="token keyword">func</span> <span class="token function">Fib</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> n
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">Fib</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Fib</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><em>fib_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> fib

<span class="token keyword">import</span> <span class="token string">&quot;testing&quot;</span>

<span class="token keyword">func</span> <span class="token function">do_task</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">,</span> n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>N<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token function">Fib</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">BenchmarkFib1</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">do_task</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkFib2</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">do_task</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkFib3</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">do_task</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkFib5</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">do_task</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkFib10</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">do_task</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkFib50</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">do_task</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS fib<span class="token punctuation">]</span><span class="token comment"># go test -bench .</span>
goos: linux
goarch: amd64
pkg: fib
cpu: AMD EPYC Processor
BenchmarkFib1-8         <span class="token number">476197117</span>                <span class="token number">2.549</span> ns/op
BenchmarkFib2-8         <span class="token number">216786968</span>                <span class="token number">6.100</span> ns/op
BenchmarkFib3-8         <span class="token number">128765414</span>                <span class="token number">9.580</span> ns/op
BenchmarkFib5-8         <span class="token number">45925664</span>                <span class="token number">31.64</span> ns/op
BenchmarkFib10-8         <span class="token number">3360859</span>               <span class="token number">328.3</span> ns/op
BenchmarkFib50-8               <span class="token number">1</span>        <span class="token number">81771779865</span> ns/op
PASS
ok      fib     <span class="token number">90</span>.914s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>BenchmarkFib50</code> 只运行了一次，可能就会有误差，可以设置最小基准时间 <code>-benchtime</code>，增加运行次数</p></li> <li><h3 id="重置运行时间"><a href="#重置运行时间" class="header-anchor">#</a> 重置运行时间</h3> <p>有些时候会有有些无关紧要的操作比如 <code>time.Sleep</code> 影响测试结果，我们可以执行 <code>b.ResetTimer</code> 重置运行时间</p> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> test <span class="token keyword">struct</span> <span class="token punctuation">{</span>
		input <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
		sep   <span class="token builtin">string</span>
		want  <span class="token builtin">string</span>
	<span class="token punctuation">}</span>
	tests <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>test<span class="token punctuation">{</span>
		<span class="token string">&quot;simple&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;hgnu&quot;</span><span class="token punctuation">:</span>   <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// &quot;abc&quot;:    {[]string{}, &quot;-&quot;, &quot;null&quot;},</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> name<span class="token punctuation">,</span> tc <span class="token operator">:=</span> <span class="token keyword">range</span> tests <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>tc<span class="token punctuation">.</span>input<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>sep<span class="token punctuation">)</span>
			<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkJoin</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>N<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">BenchmarkJoinSleep</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>N<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkJoinSleepResetTimer</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
	b<span class="token punctuation">.</span><span class="token function">ResetTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>N<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -bench .</span>
goos: linux
goarch: amd64
pkg: <span class="token function">join</span>
cpu: AMD EPYC Processor
BenchmarkJoin-8                         <span class="token number">18337059</span>                <span class="token number">70.53</span> ns/op
BenchmarkJoinSleep-8                           <span class="token number">1</span>        <span class="token number">1000581868</span> ns/op
BenchmarkJoinSleepResetTimer-8          <span class="token number">17905347</span>                <span class="token number">66.42</span> ns/op
PASS
ok      <span class="token function">join</span>    <span class="token number">10</span>.953s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><h3 id="并行测试"><a href="#并行测试" class="header-anchor">#</a> 并行测试</h3> <p><code>Go</code> 有个最大的优势就是并发，所以并行测试也必不可少，<code>*testing.B</code> 提供了 <code>*RunParallel</code> 函数进行并发测试</p> <p>由于虚拟机只有一个 <code>vCPU</code>，使用我自己电脑测试</p> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;reflect&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestJoin</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> test <span class="token keyword">struct</span> <span class="token punctuation">{</span>
		input <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
		sep   <span class="token builtin">string</span>
		want  <span class="token builtin">string</span>
	<span class="token punctuation">}</span>
	tests <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>test<span class="token punctuation">{</span>
		<span class="token string">&quot;simple&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ABC-XYZ-WWW&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;hgnu&quot;</span><span class="token punctuation">:</span>   <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;中国&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;湖北&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;黄冈师范学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;中国-湖北-黄冈-黄冈师范学院-HGNU&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// &quot;abc&quot;:    {[]string{}, &quot;-&quot;, &quot;null&quot;},</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> name<span class="token punctuation">,</span> tc <span class="token operator">:=</span> <span class="token keyword">range</span> tests <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			got <span class="token operator">:=</span> <span class="token function">Join</span><span class="token punctuation">(</span>tc<span class="token punctuation">.</span>input<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>sep<span class="token punctuation">)</span>
			<span class="token keyword">if</span> <span class="token operator">!</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>got<span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;excepted:%v, got:%v&quot;</span><span class="token punctuation">,</span> tc<span class="token punctuation">.</span>want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkJoin</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>N<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">BenchmarkJoinParallel</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;XYZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">}</span>
	b<span class="token punctuation">.</span><span class="token function">SetParallelism</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
	b<span class="token punctuation">.</span><span class="token function">RunParallel</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>p <span class="token operator">*</span>testing<span class="token punctuation">.</span>PB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> p<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">Join</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><div class="language-powershell line-numbers-mode"><pre class="language-powershell"><code>D:\Desktop\join&gt;go test <span class="token operator">-</span>bench <span class="token punctuation">.</span>
goos: windows
goarch: amd64
pkg: join
cpu: Intel<span class="token punctuation">(</span>R<span class="token punctuation">)</span> Core<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> i5-9300H CPU @ 2<span class="token punctuation">.</span>40GHz
BenchmarkJoin-8                 22852267                48<span class="token punctuation">.</span>23 ns/op
BenchmarkJoinParallel-8         51907125                23<span class="token punctuation">.</span>58 ns/op
PASS
ok      join    3<span class="token punctuation">.</span>980s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul></li> <li><h2 id="示例测试"><a href="#示例测试" class="header-anchor">#</a> 示例测试</h2> <ul><li><h2 id="基本格式-3"><a href="#基本格式-3" class="header-anchor">#</a> 基本格式</h2> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">ExampleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token comment">// Output</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>需要注释一个 <code>Output</code></p> <p>并且将预期输出的内容也注释出来</p></li> <li><h3 id="基本示例"><a href="#基本示例" class="header-anchor">#</a> 基本示例</h3> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">ExampleJoin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CCTV&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token comment">// Output:</span>
	<span class="token comment">// ABC-WWW-CCTV</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span><span class="token comment"># go test -run Example</span>
PASS
ok      <span class="token function">join</span>    <span class="token number">0</span>.006s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果不加预期输出</p> <p><em>join_test.go</em></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> join

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">ExampleJoin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;WWW&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CCTV&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token punctuation">[</span>root@CentOS join<span class="token punctuation">]</span># <span class="token keyword">go</span> test <span class="token operator">-</span>run Example
testing<span class="token punctuation">:</span> warning<span class="token punctuation">:</span> no tests to run
PASS
ok      join    <span class="token number">0</span><span class="token punctuation">.</span>006s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>提示：<code>testing: warning: no tests to run</code></p></li></ul></li> <li><h2 id="testmain"><a href="#testmain" class="header-anchor">#</a> <code>TestMain</code></h2> <p>用于测试程序在测试前额外的设置（<code>setup</code>）和测试之后额外的拆卸（<code>teardown</code>）</p> <p>如果我们没有自定义 <code>TestMain</code> 函数，默认的 <code>TestMain</code> 函数相当于下面这个：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestMain</span><span class="token punctuation">(</span>m <span class="token operator">*</span>testing<span class="token punctuation">.</span>M<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 测试之前的一些操作</span>
    retCode <span class="token operator">:=</span> m<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
	<span class="token comment">// 测试之后的一些操作</span>
os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span>retCode<span class="token punctuation">)</span> <span class="token comment">//退出</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>  
  `m.Run()` 就是执行测试，如果不调用，测试就直接退出了。
  
  - ### 读取命令行参数的示例
  
    *join_test.go*
  
    ```go
    package join
    
    import (
    	&quot;flag&quot;
    	&quot;fmt&quot;
    	&quot;os&quot;
    	&quot;strings&quot;
    	&quot;testing&quot;
    )
    
    func TestJoin(t *testing.T) {
    	str := Join(slice, &quot;-&quot;)
    	fmt.Println(str)
    }
    
    var sliceStr string
    var slice []string
    
    func init() {
    	//变量,参数名,默认值,说明
    	flag.StringVar(&amp;sliceStr, &quot;str&quot;, &quot;ABC,XYZ,WWW&quot;, &quot;要合并的字符串数组，半角逗号分割（默认：ABC,XYZ,WWW）&quot;)
    }
    func TestMain(m *testing.M) {
    	fmt.Println(&quot;我执行了~~~&quot;)
    	flag.Parse()
    	slice = strings.Split(sliceStr, &quot;,&quot;)
    	retCode := m.Run()
    	fmt.Println(&quot;执行之后的一些操作&quot;)
    	os.Exit(retCode)
    }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><div class="language- extra-class"><pre><code>```shell
[root@CentOS join]# go test -str 123,ABC,WWW
我执行了~~~
123-ABC-WWW
PASS
执行之后的一些操作
ok      join    0.002s
```
</code></pre></div></li> <li><h1 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h1> <p>个人理解：一种包含了接收者（<code>recover</code>）的特殊函数，接收者可以为任意类型，而不是只能是”类“，如何通过 <code>T.Xxx()</code> 的方式调用</p> <p><em><a href="https://www.xxcheng.cn/756.html#cl-19" target="_blank" rel="noopener noreferrer">函数相关学习笔记<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></em></p> <ul><li><h2 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h2> <ul><li>只能与接收者处于一个包内；</li> <li>接收者可以是任意数据类型；</li> <li>不支持重载；</li> <li>接收者支持对应类型的指针 <code>*T</code>，基础类型除外；</li> <li>调用时不会区分是普通类型的接收者还是指针类型的接收者，所有方法都可以调用，编译器会自动识别转换；</li></ul></li> <li><h2 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h2> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>recevier <span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token function">methodName</span><span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span><span class="token punctuation">(</span>返回值列表<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>recevier <span class="token operator">*</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token function">methodName</span><span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span><span class="token punctuation">(</span>返回值列表<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><h2 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h2> <p>先预定义一个 <code>Cup</code> 结构体</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Cup <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	id    <span class="token builtin">int</span>
	color <span class="token builtin">string</span>
	weight <span class="token builtin">float32</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><h3 id="只能在一个包内"><a href="#只能在一个包内" class="header-anchor">#</a> 只能在一个包内</h3> <p>执行会报错，因为 <code>int</code> 不在一个包内，而不是不支持基础类型，解决办法是使用别名</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>i <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token function">PrintInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;我是：&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>cannot define new methods on non-local type int
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn-static.xxcheng.cn/static/blog/images/2023/07/07/fa8ced732d8f6de751e62595976e833d.png" alt="image-20230707172823229"></p></li> <li><h3 id="基础类型的接收者"><a href="#基础类型的接收者" class="header-anchor">#</a> 基础类型的接收者</h3> <p>使用别名实现 <code>int</code> 类型的接收者</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> my2Int <span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>i my2Int<span class="token punctuation">)</span> <span class="token function">PrintInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;我是：&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">Test_07_2</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a my2Int <span class="token operator">=</span> <span class="token number">1</span>
	a<span class="token punctuation">.</span><span class="token function">PrintInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS single<span class="token punctuation">]</span><span class="token comment"># go test -v  day07_test.go -run Test_07_2</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   Test_07_2
我是： <span class="token number">1</span>
--- PASS: Test_07_2 <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
PASS
ok      command-line-arguments  <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><h3 id="不区分普通类型还是指针类型的接收者"><a href="#不区分普通类型还是指针类型的接收者" class="header-anchor">#</a> 不区分普通类型还是指针类型的接收者</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>c Cup<span class="token punctuation">)</span> <span class="token function">Say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;我的ID:&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string">&quot;我的颜色:&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>color<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Cup<span class="token punctuation">)</span> <span class="token function">UpdateColor</span><span class="token punctuation">(</span>color <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c<span class="token punctuation">.</span>color <span class="token operator">=</span> color
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">Test_07_3</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> Cup<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;白色&quot;</span><span class="token punctuation">,</span> <span class="token number">2.23</span><span class="token punctuation">}</span>
	c<span class="token punctuation">.</span><span class="token function">Say</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">UpdateColor</span><span class="token punctuation">(</span><span class="token string">&quot;黑色&quot;</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">Say</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@CentOS single<span class="token punctuation">]</span><span class="token comment"># go test -v  day07_test.go -run Test_07_3</span>
<span class="token operator">==</span><span class="token operator">=</span> RUN   Test_07_3
我的ID: <span class="token number">0</span> 我的颜色: 白色
我的ID: <span class="token number">0</span> 我的颜色: 黑色
--- PASS: Test_07_3 <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
PASS
ok      command-line-arguments  <span class="token number">0</span>.002s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul></li> <li><h2 id="匿名字段"><a href="#匿名字段" class="header-anchor">#</a> 匿名字段</h2> <p>见<a href="https://www.xxcheng.cn/754.html#cl-32" target="_blank" rel="noopener noreferrer">匿名嵌套结构体<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><h2 id="方法集"><a href="#方法集" class="header-anchor">#</a> 方法集</h2> <ul><li>类型 <code>T</code> 方法集包含所有接收者为 <code>T</code> 的方法；</li> <li>类型 <code>*T</code> 方法集包含所有接收者为 <code>T</code> 和 <code>*T</code> 的方法；</li> <li>类型 <code>S</code> 如果保护匿名字段 <code>T</code>，则 <code>S</code> 和 <code>*S</code> 的方法集包含 <code>T</code> 的方法集；</li> <li>类型 <code>S</code> 如果保护匿名字段 <code>*T</code>，则 <code>S</code> 和 <code>*S</code> 的方法集包含 <code>T</code> 和 <code>*T</code> 的方法集；</li></ul> <p>上面定义在实际调用中不受约束，编译器会自动识别运行的</p></li> <li><h2 id="方法表达式"><a href="#方法表达式" class="header-anchor">#</a> 方法表达式</h2> <p>将方法赋值给一个变量</p> <p><em><strong>方法表达式受到方法集的约束</strong></em></p> <ul><li><h3 id="实现方式"><a href="#实现方式" class="header-anchor">#</a> 实现方式</h3> <ul><li><h4 id="method-value-方法值"><a href="#method-value-方法值" class="header-anchor">#</a> <code>method value</code> 方法值</h4> <p>隐式调用，通过 <code>struct</code> 实例获取到方法对象</p></li> <li><h4 id="method-expression-方法表达式"><a href="#method-expression-方法表达式" class="header-anchor">#</a> <code>method expression</code> 方法表达式</h4> <p>显示调用，通过 <code>struct</code> 类型获取到方法对应，调用时第一个参数输入对应的一个实例</p></li></ul></li> <li><h3 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Test_07_4</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> Cup<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;红色&quot;</span><span class="token punctuation">,</span> <span class="token number">3.55</span><span class="token punctuation">}</span>
	c2 <span class="token operator">:=</span> Cup<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;白色&quot;</span><span class="token punctuation">,</span> <span class="token number">6.66</span><span class="token punctuation">}</span>
	say <span class="token operator">:=</span> c<span class="token punctuation">.</span>Say
	updateColor <span class="token operator">:=</span> c<span class="token punctuation">.</span>UpdateColor

	say2 <span class="token operator">:=</span> Cup<span class="token punctuation">.</span>Say
	updateColor2 <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token operator">*</span>Cup<span class="token punctuation">)</span><span class="token punctuation">.</span>UpdateColor

	<span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">say2</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span>

	<span class="token function">updateColor</span><span class="token punctuation">(</span><span class="token string">&quot;黑色&quot;</span><span class="token punctuation">)</span>
	<span class="token function">updateColor2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c2<span class="token punctuation">,</span> <span class="token string">&quot;绿色&quot;</span><span class="token punctuation">)</span>

	<span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">say2</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul></li></ul></li> <li><h1 id="参考链接"><a href="#参考链接" class="header-anchor">#</a> 参考链接</h1> <ul><li><a href="https://pkg.go.dev/testing?utm_source=godoc#hdr-Examples" target="_blank" rel="noopener noreferrer">testing package - testing - Go Packages : Examples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.topgoer.com/%E6%96%B9%E6%B3%95/%E6%96%B9%E6%B3%95%E9%9B%86.html" target="_blank" rel="noopener noreferrer">方法-方法集<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/phpper/p/12370086.html" target="_blank" rel="noopener noreferrer">GO的方法值和方法表达式用法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/07/09, 09:53:04</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/535f9a/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">golang夯实基础第六天</div></a> <a href="/pages/5eee91/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">golang夯实基础第八天</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/535f9a/" class="prev">golang夯实基础第六天</a></span> <span class="next"><a href="/pages/5eee91/">golang夯实基础第八天</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/bc0f7f/"><div>
            Go：GMP模型深入理解
            <!----></div></a> <span class="date">01-10</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/82ad4c/"><div>
            rpc学习：进阶到gRPC
            <!----></div></a> <span class="date">01-04</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/69ce89/"><div>
            配置
            <!----></div></a> <span class="date">12-12</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:developer@xxcheng.cn" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/xxcheng" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://www.xxcheng.cn" title="首页" target="_blank" class="iconfont icon-mao"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span>xxcheng | <a href="http://beian.miit.gov.cn" class="icpnum" target="_blank" rel="noreferrer">浙ICP备19024050号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.93b3f0b1.js" defer></script><script src="/assets/js/2.aec7a7f0.js" defer></script><script src="/assets/js/21.8ccae75c.js" defer></script>
  </body>
</html>
